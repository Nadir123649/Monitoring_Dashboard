<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fixed 3D Pie Chart</title>
  <script src="https://code.highcharts.com/highcharts.js"></script>
  <script src="https://code.highcharts.com/highcharts-3d.js"></script>
  <script src="https://code.highcharts.com/modules/exporting.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
  <style>
    .scrollable-legend {
      max-height: 500px;
      overflow-y: auto;
    }
  </style>
</head>
<body class="p-6 bg-gray-100">
  <div class="p-6 bg-white shadow-md rounded-2xl">
    <!-- Flex container: chart left, legend right -->
    <div class="flex flex-col items-start gap-6 lg:flex-row">
      <!-- Pie Chart Container -->
      <div class="w-full lg:w-2/3">
        <div
          id="pieCard"
          class="relative bg-white rounded-[40px] p-0 md:p-12 min-h-[550px] overflow-hidden transition-transform duration-500 ease-in-out hover:scale-[1.02]"
        >
          <!-- Background effect -->
          <div
            class="absolute inset-0 bg-[length:40px_40px] bg-[linear-gradient(rgba(0,212,255,0.03)_1px,transparent_1px),linear-gradient(90deg,rgba(0,212,255,0.03)_1px,transparent_1px)] rounded-[40px] animate-gridMove"
          ></div>
          <div
            class="absolute top-[15%] right-[10%] w-20 h-20 rounded-full bg-[radial-gradient(circle,rgba(0,212,255,0.2),rgba(0,106,255,0.1))] filter blur-3xl animate-float"
          ></div>
          <div
            class="absolute bottom-[20%] left-[15%] w-16 h-16 rounded-full bg-[radial-gradient(circle,rgba(255,0,110,0.2),rgba(131,56,236,0.1))] filter blur-2xl animate-[float_8s_ease-in-out_infinite_reverse]"
          ></div>
          <div class="absolute inset-0 bg-white/5 backdrop-blur-[30px] rounded-[40px] border border-white/5"></div>

          <!-- Chart Canvas -->
          <div id="pieContainer" class="relative z-10 w-full h-[380px] bg-transparent rounded-2xl"></div>
        </div>
      </div>

      <!-- Custom Scrollable Legend -->
      <div
        id="pieLegend"
        class="w-full p-4 border border-gray-200 lg:w-1/3 scrollable-legend bg-white/90 backdrop-blur-md rounded-2xl"
      ></div>
    </div>
  </div>

  <script>
    const dataOne = [
      {
        name: "Verification Success",
        value: 72,
        colors: ["#00d4ff", "#006eff", "#0047ff"],
      },
      {
        name: "Abandoned by Customer",
        value: 16,
        colors: ["#ff006e", "#8338ec", "#3a86ff"],
      },
      {
        name: "Verification Failure",
        value: 11,
        colors: ["#06ffa5", "#00d4aa", "#0056b3"],
      },
      { name: "Not Started", value: 1, colors: ["#ffbe0b", "#fb8500", "#ff006e"] },
    ];

    const total = dataOne.reduce((a, b) => a + b.value, 0);

    Highcharts.chart("pieContainer", {
      chart: {
        type: "pie",
        options3d: { enabled: true, alpha: 35, depth: 45 },
        backgroundColor: "transparent",
        height: 380,
      },
      title: {
        useHTML: true,
        text: `<div style="text-align:center;padding:25px">
            <div style="font-size:48px;font-weight:900;color:#111;animation:pulse 2s infinite">${total}</div>
            <div style="font-size:11px;color:#222;font-weight:700;text-transform:uppercase;letter-spacing:4px;animation:fadeIn 3s ease-in">TOTAL DATA POINTS</div>
          </div>`,
        align: "center",
        verticalAlign: "middle",
        floating: true,
        y: 0,
      },
      credits: { enabled: false },
      plotOptions: {
        pie: {
          innerSize: "55%",
          depth: 45,
          borderRadius: 25,
          cursor: "pointer",
          dataLabels: {
            enabled: true,
            format: "{point.percentage:.0f}%",
            style: { fontSize: "12px", fontWeight: "900", color: "#111" },
            distance: -22,
          },
          animation: { duration: 2500 },
        },
      },
      tooltip: {
        backgroundColor: "white",
        borderRadius: 20,
        borderWidth: 0,
        shadow: true,
        style: { fontSize: "13px", fontWeight: "600", color: "#000" },
        formatter() {
          return `<div style="padding:20px;text-align:center">
                <div style="font-weight:900;color:#111;margin-bottom:10px;font-size:15px;text-transform:uppercase">${
                  this.point.name
                }</div>
                <div style="color:#222;margin-bottom:6px">Value: <span style="font-weight:800;color:#111">${
                  this.y
                }</span></div>
                <div style="color:#222">Share: <span style="font-weight:800;color:#111">${this.percentage.toFixed(
                  1
                )}%</span></div>
              </div>`;
        },
      },
      legend: { enabled: false },
      series: [
        {
          name: "Data",
          data: dataOne.map((d) => ({
            name: d.name,
            y: d.value,
            color: {
              linearGradient: { x1: 0, y1: 0, x2: 1, y2: 1 },
              stops: d.colors.map((c, i) => [i / (d.colors.length - 1), c]),
            },
            sliced: true,
          })),
          animation: { duration: 2500 },
        },
      ],
    });

    // Custom Legend
    const legendEl = document.getElementById("pieLegend");
    dataOne.forEach((d) => {
      const box = document.createElement("div");
      box.className =
        "flex items-center gap-2 px-4 py-3 mb-2 transition transform cursor-pointer bg-white/95 backdrop-blur-lg rounded-xl hover:-translate-y-1 hover:scale-105";

      const dot = document.createElement("div");
      dot.className = "w-4 h-4 rounded-full animate-pulse";
      dot.style.background = d.colors[d.colors.length - 1];
      dot.style.boxShadow = `0 0 10px ${d.colors[d.colors.length - 1]}80`;

      const label = document.createElement("span");
      label.className = "text-xs font-semibold text-gray-800 uppercase";
      label.textContent = d.name;

      box.append(dot, label);
      legendEl.appendChild(box);
    });
  </script>
</body>
</html>
